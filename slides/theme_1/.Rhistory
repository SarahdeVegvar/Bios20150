install.packages(c("abbyyR", "abcrf", "abctools", "BH", "curl", "evd", "ggplot2", "ggthemes", "httr", "knitr", "mosaic", "mosaicData", "plotly", "prodlim", "R6", "Rcpp", "rmarkdown", "tidyr", "viridis"))
setwd("~/github/Bios20150/slides/theme_1")
a <- read.csv("../../data/theme_1/us_pop.csv")
a <- read.csv("../../data/theme_1/us_pop.csv", header = TRUE, sep = "\t")
a
a <- read.csv("../../data/theme_1/us_pop.csv", header = TRUE, sep = "\s")
a <- read.csv("../../data/theme_1/us_pop.csv", header = TRUE, sep = " ")
a
a <- read.csv("../../data/theme_1/us_pop.csv", header = TRUE, sep = "\t")
a
a <- read.csv("../../data/theme_1/us_pop.csv", header = TRUE, sep = "\t")
a
plot(a[,2]~a[,1])
dim(a)
a <- read.csv("../../data/theme_1/us_pop.csv", header = TRUE, sep = "\t")
dim(a)
a <- read.csv("../../data/theme_1/us_pop.csv", header = TRUE, sep = "\t")
dim(a)
a <- read.csv("../../data/theme_1/us_pop.csv", sep = "\t")
dim(a)
a[1,]
a[2,]
a <- read.csv("../../data/theme_1/us_pop.csv", sep = "\t", row.names = FALSE)
a <- read.csv("../../data/theme_1/us_pop.csv", sep = "\t", rownames = FALSE)
a <- read.csv("../../data/theme_1/us_pop.csv")
dim(a)
plot(a[,2]~a[,1])
year0 <- 1660
year1 <- 1680
year2 <- 1700
us_pop <- read.csv("../../data/theme_1/us_pop.csv")
X0 <- us_pop$Population[which(us_pop$Year == year0)]
X1 <- us_pop$Population[which(us_pop$Year == year0)]
X2 <- us_pop$Population[which(us_pop$Year == year0)]
X0
X1
X2
X0 <- us_pop$Population[which(us_pop$Year == year0)]
X1 <- us_pop$Population[which(us_pop$Year == year1)]
X2 <- us_pop$Population[which(us_pop$Year == year2)]
x2
X2
K <- X1 * (X0 * X1 + X1 * X2 - 2 * X0 * X2) / (X1^2 - X0 * X2)
X0 <- 1.0 * us_pop$Population[which(us_pop$Year == year0)]
X1 <- 1.0 * us_pop$Population[which(us_pop$Year == year1)]
X2 <- 1.0 * us_pop$Population[which(us_pop$Year == year2)]
K <- X1 * (X0 * X1 + X1 * X2 - 2 * X0 * X2) / (X1^2 - X0 * X2)
K
r <- (1 / 20) * log((1 / X0 - 1 / K) / (1 / X1 - 1 / K))
r
yearshift <- us_pop$Year - year0
yearshift
predicted <- X0 * exp(r * yearshift) / (1 + X0 * (exp(r * yearshift) - 1) / K)
predicted
plot(us_pop$Year, us_pop$Population)
points(us_pop$Year, predicted, col = "red")
year0 <- 1670
year1 <- 1670 + 50
year2 <- 1670 + 100
X0 <- 1.0 * us_pop$Population[which(us_pop$Year == year0)]
X1 <- 1.0 * us_pop$Population[which(us_pop$Year == year1)]
X2 <- 1.0 * us_pop$Population[which(us_pop$Year == year2)]
K <- X1 * (X0 * X1 + X1 * X2 - 2 * X0 * X2) / (X1^2 - X0 * X2)
r <- (1 / 50) * log((1 / X0 - 1 / K) / (1 / X1 - 1 / K))
r
yearshift <- us_pop$Year - year0
predicted <- X0 * exp(r * yearshift) / (1 + X0 * (exp(r * yearshift) - 1) / K)
us_pop$Predicted <- predicted
pl_us_fit <- ggplot(data = us_pop, aes(x = Year, y = Population)) + geom_point() + geom_line(aes(x = Year, y = Predicted), colour = "red")  + geom_point(x = year0, y = X0, colour = "red") + geom_point(x = year1, y = X1, colour = "red") + geom_point(x = year2, y = X2, colour = "red") + theme_bw() +
theme(axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=14, face="bold")) +
theme(legend.position = "none")
print(pl_us_fit)
library(ggplot2)
pl_us_fit <- ggplot(data = us_pop, aes(x = Year, y = Population)) + geom_point() + geom_line(aes(x = Year, y = Predicted), colour = "red")  + geom_point(x = year0, y = X0, colour = "red") + geom_point(x = year1, y = X1, colour = "red") + geom_point(x = year2, y = X2, colour = "red") + theme_bw() +
theme(axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=14, face="bold")) +
theme(legend.position = "none")
library(ggplot2)
pl_us_fit
Predicted
predicted
r
K
K <- X1 * (X0 * X1 + X1 * X2 - 2 * X0 * X2) / (X1^2 - X0 * X2)
K
SignPattern <- as.matrix(c( 0,  0,  0, 1,
0, -1, -1, 0,
0,  1,  0, 0,
-1, 0, 0, 0), 4, 4, byrow = TRUE)
source('~/Desktop/Rama_4.R')
eigen(Z)$values
Z
source('~/Desktop/Rama_4.R')
source('~/Desktop/Rama_4.R')
eigen(Z)$values
source('~/Desktop/Rama_4.R')
source('~/Desktop/Rama_4.R')
source('~/Desktop/Rama_4.R')
source('~/Desktop/Rama_4.R')
SignPattern
SignPattern[c(1,4,2,3), c(1,4,2,3)]
